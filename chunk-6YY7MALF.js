import{i as b}from"./chunk-2SHNUN5D.js";import{i as w,j as I}from"./chunk-CD7FGRAU.js";import{a as h}from"./chunk-PSQRUING.js";import{E as C}from"./chunk-VOH7XGOR.js";import{b as g}from"./chunk-XGVKSCMM.js";import{g as m}from"./chunk-JEGVIFEP.js";var N=/^-?(\d+)(\.(\d+))?$/i;function M(t,e){return t-e}function R(t,e){let n,i;return n=Number(t.toFixed(e)),n<t?i=n+1/10**e:(i=n,n-=1/10**e),n=Number(n.toFixed(e)),i=Number(i.toFixed(e)),[n,i]}function v(t,e,n,i,o){let a=y(t,e,n,i),r=a.previous==null||a.previous<=o,l=a.next==null||a.next<=o;return r&&l||a.previous+a.next<=2*o}function V(t){let e=String(t),n=e.match(N);if(n?.[1])return{integer:n[1].split("").length,fractional:n[3]?n[3].split("").length:0};if(e.toLowerCase().includes("e")){let i=e.split("e"),o=i[0],a=i[1];if(o&&a){let r=Number(o),l=Number(a),s=l>0;s||(l=Math.abs(l));let A=V(r);return s?(A.integer+=l,l>A.fractional?A.fractional=0:A.fractional-=l):(A.fractional+=l,l>A.integer?A.integer=1:A.integer-=l),A}}return{integer:0,fractional:0}}function y(t,e,n,i){let o={previous:null,next:null};if(n!=null){let a=t-n,r=e-n-a;o.previous=Math.floor(Math.abs(100*r/a))}if(i!=null){let a=i-t,r=i-e-a;o.next=Math.floor(Math.abs(100*r/a))}return o}function O(t,e={}){let n=t.slice(0),{tolerance:i=2,strictBounds:o=!1,indexes:a=n.map((r,l)=>l)}=e;a.sort(M);for(let r=0;r<a.length;r++){let l=a[r],s=n[l],A=l===0?null:n[l-1],F=l===n.length-1?null:n[l+1],p=V(s).fractional;if(p){let u,c=0,f=!1;for(;c<=p&&!f;){let d=R(s,c);u=o&&r===0?d[1]:d[0],f=v(s,u,A,F,i),c++}f&&(n[l]=u)}}return n}var B={maximumFractionDigits:20};function U(t){return g(t,B)}var T="<",x=">";function H(t,e,n,i){let o="";return e===0?o=`${T} `:e===n&&(o=`${x} `),o+(i?I(t,i):U(t))}var Z=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII=","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII="];function E(t){return m(this,null,function*(){if(!("visualVariables"in t)||!t.visualVariables)return null;let e=t.visualVariables.find(r=>r.type==="color");if(!e)return null;let n=null,i=null;if(e.stops){if(e.stops.length===1)return e.stops[0].color;n=e.stops[0].value,i=e.stops[e.stops.length-1].value}let o=n!=null&&i!=null?n+(i-n)/2:0,{getColor:a}=yield import("./chunk-VXKLTDGB.js");return a(e,o)??null})}function X(t,e){return m(this,null,function*(){let n=t.trailCap,i=t.trailWidth||1,o=e||(yield E(t))||t.color;return new b({cap:n,color:o,width:i})})}function Y(t){return t!=null&&typeof t=="object"&&"min"in t&&"max"in t}function Q(t,e){if(!e.field)return null;if("featureReduction"in t)switch(t.featureReduction?.type){case"cluster":case"binning":{let n=t.featureReduction.fields.find(({name:i})=>i.toLowerCase()===e.field.toLowerCase());return n&&"getField"in t?t.getField(n.onStatisticField):null}}return"getField"in t?t.getField?.(e.field):null}function S(t,e){let n="popupTemplate"in t?t.popupTemplate?.fieldInfos:null;if(n?.length&&e)return n.find(i=>i.fieldName?.toLowerCase()===e.toLowerCase())?.format?.dateFormat}function P(t,e,n){let i=Q(t,e);if(!i||!w(i)&&!C(i))return null;let o=S(t,i.name);if(!o&&i.type==="date"){let a=0,r=0;e.stops?(a=e.stops?.at(0)?.value??a,r=e.stops?.at(-1)?.value??r):"minDataValue"in e&&"maxDataValue"in e&&(a=e.minDataValue??a,r=e.maxDataValue??r),o=r-a>2*h.days?"short-date":"short-date-short-time"}return{fieldType:i.type,format:o,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in t?t.preferredTimeZone:null,viewTimeZone:n,datesInUnknownTimezone:"datesInUnknownTimezone"in t&&t.datesInUnknownTimezone}}}function $(t){if("authoringInfo"in t)return t.authoringInfo?.visualVariables?.find(({theme:e})=>e==="reference-size")}export{V as a,y as b,O as c,T as d,x as e,H as f,Z as g,E as h,X as i,Y as j,P as k,$ as l};
