import{a as d,b,c,e as W}from"./chunk-G2AVDS62.js";import{a as H}from"./chunk-GGQ2PCO6.js";import"./chunk-KFCU4KQY.js";import"./chunk-WNOBQY3K.js";import"./chunk-QS6RCA6Y.js";import{a as C}from"./chunk-6NTMQUAJ.js";import{a as T}from"./chunk-APGKXN3F.js";import{c as R}from"./chunk-PHCUTV4M.js";import"./chunk-7C77LBCZ.js";import"./chunk-LK52GLIE.js";import{a as P}from"./chunk-GHKFJTCN.js";import{a as z}from"./chunk-IZF35GKA.js";import{e as A}from"./chunk-KS53OQGV.js";import{a as K}from"./chunk-EB5RRWIA.js";import{a as V}from"./chunk-RWIKH4KN.js";import"./chunk-MP46524Y.js";import"./chunk-UH6DTPOD.js";import"./chunk-N3BNSVOS.js";import"./chunk-XCJPZZY7.js";import"./chunk-Y2F4CIGY.js";import"./chunk-BPPBSQ5N.js";import"./chunk-2AAD7VYB.js";import"./chunk-7TBWQ2OA.js";import"./chunk-DVSFGYL7.js";import"./chunk-3JO3IXGW.js";import"./chunk-U436ZYW5.js";import"./chunk-DACZ4LLK.js";import"./chunk-2EOPE46E.js";import"./chunk-2UGJ72JG.js";import"./chunk-LWI2RQ66.js";import"./chunk-LOEAA5XF.js";import"./chunk-MAPO7YGF.js";import"./chunk-OLIJD5I4.js";import"./chunk-OOE2LCNP.js";import"./chunk-I3S324BU.js";import"./chunk-ESBNO4XM.js";import"./chunk-3A7OIH4J.js";import"./chunk-RMS5474O.js";import"./chunk-2SHNUN5D.js";import"./chunk-IFCRPPYQ.js";import"./chunk-FDQ4JKC5.js";import"./chunk-NAV5L5PJ.js";import"./chunk-EK4W5QYS.js";import"./chunk-WMT47BMV.js";import"./chunk-PJQZD5QI.js";import"./chunk-IEUNGS56.js";import"./chunk-6KRFVLII.js";import"./chunk-SPAOTNUK.js";import"./chunk-JHZRGEBS.js";import"./chunk-UYBHUOFR.js";import"./chunk-BYQI7UDX.js";import"./chunk-BES4JRIO.js";import"./chunk-SSGUIPHM.js";import"./chunk-7WFRJSY3.js";import"./chunk-PSQRUING.js";import"./chunk-DFTBSFIN.js";import"./chunk-3JLZ7SFH.js";import"./chunk-FUBITVJ7.js";import"./chunk-VOH7XGOR.js";import"./chunk-Y6HWUWZ3.js";import"./chunk-AQ74ANSJ.js";import"./chunk-5UCI4TUX.js";import"./chunk-SAOUSUZE.js";import"./chunk-PPFMRTTD.js";import"./chunk-IWJQ3PU6.js";import"./chunk-Z5Q76SB7.js";import"./chunk-TTN7UOJS.js";import"./chunk-5QLB7ZJ7.js";import"./chunk-E5R4OI7X.js";import"./chunk-N566L3JG.js";import"./chunk-7S6PD5JC.js";import{a as I}from"./chunk-ZWI7LLTZ.js";import"./chunk-6NCXSKJD.js";import"./chunk-ATXTHXJA.js";import"./chunk-VFINLX57.js";import"./chunk-LM5MGO7W.js";import"./chunk-4HUAEW4D.js";import"./chunk-XWRPBDYS.js";import"./chunk-TCCAOREC.js";import"./chunk-BCREO4Q5.js";import{a as h,v as m}from"./chunk-SO6OJFOM.js";import{a as J,b as w}from"./chunk-DG5QI6E2.js";import"./chunk-TMZNSBQB.js";import"./chunk-ZGLJFDS6.js";import"./chunk-RSDQHAJX.js";import"./chunk-OFVMJORF.js";import{a as y,c as S,d as g,f as p}from"./chunk-2FYXACXP.js";import"./chunk-XGVKSCMM.js";import"./chunk-FX2VBPAM.js";import"./chunk-K4GPNFIS.js";import{b as u}from"./chunk-RP7XSKHE.js";import{a as N}from"./chunk-VV7MGXTC.js";import"./chunk-IXNVQC76.js";import"./chunk-LYPZUCFI.js";import"./chunk-QYC4ILGT.js";import"./chunk-HFQFGALU.js";import"./chunk-5TSEU5EE.js";import"./chunk-VC35VCVT.js";import"./chunk-MT7BXRRQ.js";import"./chunk-NNKLK2DS.js";import"./chunk-VU5W7W6Y.js";import{I as j}from"./chunk-BRGZVJPZ.js";import{I as i,R as _}from"./chunk-Z5NXR7SL.js";import{S as f,z as M}from"./chunk-7JLWSSXP.js";import{a as r}from"./chunk-W3WDPWBE.js";import{k as F}from"./chunk-JKP4I6UL.js";import"./chunk-TZHKPIVH.js";import"./chunk-JPDAKIWT.js";import"./chunk-W6LY37E4.js";import{o as k}from"./chunk-BRWS572J.js";import"./chunk-AKNRR36C.js";import{a as O,g as E}from"./chunk-JEGVIFEP.js";var v,a=v=class extends N.EventedMixin(_(I)){constructor(...e){super(...e),this.description=null,this.fullExtent=null,this.id=null,this.networkLink=null,this.parent=null,this.sublayers=null,this.title=null,this.sourceJSON=null,this.layer=null,this.addHandles([S(()=>this.sublayers,"after-add",({item:t})=>{t.parent=this,t.layer=this.layer},p),S(()=>this.sublayers,"after-remove",({item:t})=>{t.layer=t.parent=null},p),y(()=>this.sublayers,(t,s)=>{if(s)for(let o of s)o.layer=o.parent=null;if(t)for(let o of t)o.parent=this,o.layer=this.layer},p),y(()=>this.layer,t=>{if(this.sublayers)for(let s of this.sublayers)s.layer=t},p)])}initialize(){g(()=>this.networkLink).then(()=>g(()=>this.visible===!0)).then(()=>this.load())}load(e){if(!this.networkLink||this.networkLink.viewFormat)return;let t=e!=null?e.signal:null,s=this._fetchService(this._get("networkLink")?.href??"",t).then(o=>{let n=W(o.sublayers);this.fullExtent=m.fromJSON(n),this.sourceJSON=o;let x=M(u.ofType(v),c(v,o));this.sublayers?this.sublayers.addMany(x):this.sublayers=x,this.layer?.emit("sublayer-update"),this.layer&&this.layer.notifyChange("visibleSublayers")});return this.addResolvingPromise(s),Promise.resolve(this)}get visible(){return this._get("visible")}set visible(e){this._get("visible")!==e&&(this._set("visible",e),this.layer&&this.layer.notifyChange("visibleSublayers"))}readVisible(e,t){return!!t.visibility}_fetchService(e,t){return b(e,this.layer.outSpatialReference,this.layer.refreshInterval,t).then(s=>d(s.data))}};r([i()],a.prototype,"description",void 0),r([i({type:m})],a.prototype,"fullExtent",void 0),r([i()],a.prototype,"id",void 0),r([i({readOnly:!0,value:null})],a.prototype,"networkLink",void 0),r([i({json:{write:{allowNull:!0}}})],a.prototype,"parent",void 0),r([i({type:u.ofType(a),json:{write:{allowNull:!0}}})],a.prototype,"sublayers",void 0),r([i({value:null,json:{read:{source:"name",reader:e=>k(e)}}})],a.prototype,"title",void 0),r([i({value:!0})],a.prototype,"visible",null),r([h("visible",["visibility"])],a.prototype,"readVisible",null),r([i()],a.prototype,"sourceJSON",void 0),r([i()],a.prototype,"layer",void 0),a=v=r([f("esri.layers.support.KMLSublayer")],a);var L=a;var B=["kml","xml"],l=class extends R(T(P(z(C(K(V)))))){constructor(...e){super(...e),this._visibleFolders=[],this.allSublayers=new H({getCollections:()=>[this.sublayers],getChildrenFunction:t=>t.sublayers}),this.outSpatialReference=w.WGS84,this.path=null,this.legendEnabled=!1,this.operationalLayerType="KML",this.sublayers=null,this.type="kml",this.url=null}initialize(){this.addHandles([y(()=>this.sublayers,(e,t)=>{t&&t.forEach(s=>{s.parent=null,s.layer=null}),e&&e.forEach(s=>{s.parent=this,s.layer=this})},p),this.on("sublayer-update",()=>this.notifyChange("fullExtent"))])}normalizeCtorArgs(e,t){return typeof e=="string"?O({url:e},t):e}readSublayersFromItemOrWebMap(e,t){this._visibleFolders=t.visibleFolders}readSublayers(e,t,s){return c(L,t,s,this._visibleFolders)}writeSublayers(e,t){let s=[],o=e.toArray();for(;o.length;){let n=o[0];n.networkLink||(n.visible&&s.push(n.id),n.sublayers&&o.push(...n.sublayers.toArray())),o.shift()}t.visibleFolders=s}get title(){let e=this._get("title");return e&&this.originOf("title")!=="defaults"?e:this.url?j(this.url,B)||"KML":e}set title(e){this._set("title",e)}get visibleSublayers(){let e=this.sublayers,t=[],s=o=>{o.visible&&(t.push(o),o.sublayers&&o.sublayers.forEach(s))};return e&&e.forEach(s),t}get fullExtent(){return this._recomputeFullExtent()}load(e){let t=e!=null?e.signal:null;return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["KML"],supportsData:!1},e).catch(F).then(()=>this._fetchService(t))),Promise.resolve(this)}destroy(){super.destroy(),this.allSublayers.destroy()}_fetchService(e){return E(this,null,function*(){let t=yield Promise.resolve().then(()=>this.resourceInfo?{ssl:!1,data:this.resourceInfo}:b(this.url??"",this.outSpatialReference,this.refreshInterval,e)),s=d(t.data);s&&this.read(s,{origin:"service"})})}_recomputeFullExtent(){let e=null;this.extent!=null&&(e=this.extent.clone());let t=s=>{if(s.sublayers)for(let o of s.sublayers.items)t(o),o.visible&&o.fullExtent&&(e!=null?e.union(o.fullExtent):e=o.fullExtent.clone())};return t(this),e}};r([i({readOnly:!0})],l.prototype,"allSublayers",void 0),r([i({type:w})],l.prototype,"outSpatialReference",void 0),r([i({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],l.prototype,"path",void 0),r([i({readOnly:!0,json:{read:!1,write:!1}})],l.prototype,"legendEnabled",void 0),r([i({type:["show","hide","hide-children"]})],l.prototype,"listMode",void 0),r([i({type:["KML"]})],l.prototype,"operationalLayerType",void 0),r([i({})],l.prototype,"resourceInfo",void 0),r([i({type:u.ofType(L),json:{write:{ignoreOrigin:!0}}})],l.prototype,"sublayers",void 0),r([h(["web-map","portal-item"],"sublayers",["visibleFolders"])],l.prototype,"readSublayersFromItemOrWebMap",null),r([h("service","sublayers",["sublayers"])],l.prototype,"readSublayers",null),r([J("sublayers")],l.prototype,"writeSublayers",null),r([i({readOnly:!0,json:{read:!1}})],l.prototype,"type",void 0),r([i({json:{origins:{"web-map":{read:{source:"title"}}},write:{ignoreOrigin:!0}}})],l.prototype,"title",null),r([i(A)],l.prototype,"url",void 0),r([i({readOnly:!0})],l.prototype,"visibleSublayers",null),r([i({type:m})],l.prototype,"extent",void 0),r([i()],l.prototype,"fullExtent",null),l=r([f("esri.layers.KMLLayer")],l);var Re=l;export{Re as default};
