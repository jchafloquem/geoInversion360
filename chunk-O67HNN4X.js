import{a as v,b as S}from"./chunk-2RAG3MFG.js";import"./chunk-QAJCY744.js";import"./chunk-T3I7YJFI.js";import"./chunk-O55LGAV2.js";import"./chunk-BKLTKOZS.js";import"./chunk-WQ7SEU4C.js";import"./chunk-5NR3XNYP.js";import"./chunk-NH24IMWY.js";import"./chunk-OFUFLM2P.js";import"./chunk-IMAZWTYM.js";import"./chunk-MLIIG4W2.js";import"./chunk-A74TRSYK.js";import"./chunk-P3Z62US6.js";import"./chunk-EAOA3IP2.js";import"./chunk-4ZJCWL5T.js";import"./chunk-CKGQR2CH.js";import"./chunk-GFO5ECL6.js";import"./chunk-R4ZRZJFL.js";import"./chunk-L657QK52.js";import"./chunk-4Y7EKSO4.js";import"./chunk-GU2W3KD4.js";import"./chunk-4ZBUTOIE.js";import"./chunk-JWHIBBJK.js";import"./chunk-BYXBJQAS.js";import"./chunk-3WIR6N5K.js";import"./chunk-B4G6EV5H.js";import{a as g}from"./chunk-HRSAZUEG.js";import"./chunk-OTCE2CL6.js";import"./chunk-7C77LBCZ.js";import"./chunk-LK52GLIE.js";import"./chunk-TH7OTU7Q.js";import"./chunk-TTUUVT2M.js";import"./chunk-GUR47XNP.js";import"./chunk-KZUZOO74.js";import"./chunk-HWE2MRBZ.js";import"./chunk-BYXBJQAS.js";import"./chunk-HMLFVNCH.js";import"./chunk-MODIWOII.js";import"./chunk-4INMWFSQ.js";import"./chunk-I46ARENO.js";import"./chunk-IATQ4WNP.js";import"./chunk-SE7FIBEW.js";import"./chunk-NOUYXRP4.js";import"./chunk-GH3IUQVA.js";import"./chunk-AC7AQWXQ.js";import"./chunk-EZIYNRHJ.js";import"./chunk-J3VF5LTP.js";import"./chunk-37H4LYIE.js";import"./chunk-SRPI622Y.js";import"./chunk-4FSVG2A5.js";import"./chunk-RHABF3KL.js";import"./chunk-GHXDYQ3O.js";import"./chunk-ZOOQQO74.js";import"./chunk-P7VZMSEG.js";import"./chunk-B7IX6UFG.js";import"./chunk-HUYHDVA2.js";import"./chunk-4DVY2TZI.js";import"./chunk-BPPBSQ5N.js";import"./chunk-2B3PG2ZT.js";import"./chunk-SYTNPSW4.js";import"./chunk-XAHD7XBV.js";import"./chunk-UZSTUBKI.js";import{a as p}from"./chunk-DVSFGYL7.js";import"./chunk-2EOPE46E.js";import"./chunk-2UGJ72JG.js";import"./chunk-LOEAA5XF.js";import"./chunk-MAPO7YGF.js";import"./chunk-OLIJD5I4.js";import"./chunk-OOE2LCNP.js";import"./chunk-I3S324BU.js";import"./chunk-ESBNO4XM.js";import"./chunk-3A7OIH4J.js";import"./chunk-RMS5474O.js";import"./chunk-2SHNUN5D.js";import"./chunk-IFCRPPYQ.js";import"./chunk-I46GU3Q4.js";import"./chunk-W5OI4BJ2.js";import"./chunk-2EA2KAER.js";import"./chunk-ZAQLF7TN.js";import"./chunk-MJ4RSERD.js";import"./chunk-J57HR4DB.js";import"./chunk-Y5GQJM6D.js";import"./chunk-MXSUS5HK.js";import"./chunk-EK4W5QYS.js";import"./chunk-DKSAM23M.js";import"./chunk-SPJDFBYB.js";import"./chunk-WMT47BMV.js";import"./chunk-PJQZD5QI.js";import"./chunk-IEUNGS56.js";import"./chunk-6KRFVLII.js";import"./chunk-IEAJIOPI.js";import"./chunk-UHE637ZN.js";import"./chunk-7QY3BMVN.js";import"./chunk-NWPYI2UP.js";import"./chunk-TNPL7MIN.js";import"./chunk-UYBHUOFR.js";import"./chunk-BYQI7UDX.js";import"./chunk-SSGUIPHM.js";import"./chunk-7WFRJSY3.js";import"./chunk-PSQRUING.js";import"./chunk-3JLZ7SFH.js";import"./chunk-FUBITVJ7.js";import"./chunk-VOH7XGOR.js";import"./chunk-Y6HWUWZ3.js";import"./chunk-AQ74ANSJ.js";import"./chunk-5UCI4TUX.js";import"./chunk-SAOUSUZE.js";import"./chunk-PPFMRTTD.js";import"./chunk-IWJQ3PU6.js";import"./chunk-Z5Q76SB7.js";import"./chunk-TTN7UOJS.js";import"./chunk-5QLB7ZJ7.js";import"./chunk-E5R4OI7X.js";import"./chunk-7S6PD5JC.js";import"./chunk-ZWI7LLTZ.js";import"./chunk-6NCXSKJD.js";import"./chunk-4HUAEW4D.js";import"./chunk-XWRPBDYS.js";import"./chunk-TCCAOREC.js";import"./chunk-BCREO4Q5.js";import"./chunk-SO6OJFOM.js";import"./chunk-DG5QI6E2.js";import"./chunk-TMZNSBQB.js";import"./chunk-ZGLJFDS6.js";import"./chunk-RSDQHAJX.js";import"./chunk-OFVMJORF.js";import{a as c}from"./chunk-2FYXACXP.js";import"./chunk-XGVKSCMM.js";import"./chunk-FX2VBPAM.js";import"./chunk-K4GPNFIS.js";import"./chunk-RP7XSKHE.js";import"./chunk-VV7MGXTC.js";import"./chunk-IXNVQC76.js";import"./chunk-LYPZUCFI.js";import"./chunk-QYC4ILGT.js";import"./chunk-HFQFGALU.js";import"./chunk-5TSEU5EE.js";import"./chunk-VC35VCVT.js";import"./chunk-MT7BXRRQ.js";import"./chunk-NNKLK2DS.js";import"./chunk-VU5W7W6Y.js";import"./chunk-BRGZVJPZ.js";import{I as n}from"./chunk-Z5NXR7SL.js";import{S as u}from"./chunk-7JLWSSXP.js";import{a as r}from"./chunk-W3WDPWBE.js";import{a as _,b as f}from"./chunk-JKP4I6UL.js";import"./chunk-TZHKPIVH.js";import"./chunk-JPDAKIWT.js";import"./chunk-W6LY37E4.js";import{s as d}from"./chunk-BRWS572J.js";import"./chunk-AKNRR36C.js";import{a as m,b as y,g as h}from"./chunk-JEGVIFEP.js";var C=e=>{let t=class extends e{resume(){this._isUserPaused=!1,this.suspended||this._doResume()}pause(){this._isUserPaused=!0,this.suspended||this._doPause()}disconnect(){this._doDisconnect()}connect(){this._doConnect()}clear(){this._doClear()}constructor(...s){super(...s),this._isUserPaused=!1,this.filter=null}get connectionStatus(){return(this._isUserPaused||this.suspended)&&this._streamConnectionStatus==="connected"?"paused":this._streamConnectionStatus}_onSuspendedChange(s){s?this._doPause():this._isUserPaused||this._doResume()}};return r([n()],t.prototype,"_isUserPaused",void 0),r([n({readOnly:!0})],t.prototype,"connectionStatus",null),r([n({type:g})],t.prototype,"filter",void 0),t=r([u("esri.views.layers.StreamLayerView")],t),t};var o=class extends C(S){constructor(){super(...arguments),this.pipelineConnectionStatus="disconnected",this.pipelineErrorString=null}initialize(){this.addHandles([c(()=>this.layer.customParameters,e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.updateCustomParameters(e)})),this.layer.on("send-message-to-socket",e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.sendMessageToSocket(e)})),this.layer.on("send-message-to-client",e=>h(this,null,function*(){(yield this.getWorker()).streamMessenger.sendMessageToClient(e),this._isUserPaused&&"type"in e&&e.type==="clear"&&this.incrementSourceRefreshVersion()})),c(()=>this.layer.purgeOptions,()=>this._update()),c(()=>this.suspended,this._onSuspendedChange.bind(this))],"constructor"),this._doResume()}destroy(){this._doPause()}get connectionError(){return this.pipelineErrorString?new d("stream-controller",this.pipelineErrorString):null}on(e,t){if(Array.isArray(e))return f(e.map(i=>this.on(i,t)));let s=["data-received","message-received"].includes(e);s&&this.getWorker().then(i=>i.streamMessenger.enableEvent(e,!0));let l=super.on(e,t),a=this;return _(()=>{l.remove(),s&&(a._workerProxy.closed||a.hasEventListener(e)||a.getWorker().then(i=>i.streamMessenger.enableEvent(e,!1)))})}queryLatestObservations(e,t){return h(this,null,function*(){if(!(this.layer.timeInfo?.endField||this.layer.timeInfo?.startField||this.layer.timeInfo?.trackIdField))throw new d("streamlayer-no-timeField","queryLatestObservation can only be used with services that define a TrackIdField");let s=yield this.getWorker();return v(s.features.executeQueryForLatestObservations(this._cleanUpQuery(e),t).then(l=>{let a=p.fromJSON(l);return a.features.forEach(i=>{i.layer=this.layer,i.sourceLayer=this.layer}),a}),new p({features:[]}))})}detach(){super.detach(),this.pipelineConnectionStatus="disconnected"}get _streamConnectionStatus(){return this.pipelineConnectionStatus}_doPause(){this._refreshInterval!=null&&(clearInterval(this._refreshInterval),this._refreshInterval=null)}_doResume(){this._refreshInterval=setInterval(()=>this.incrementSourceRefreshVersion(),this.layer.updateInterval)}_doDisconnect(){this.getWorker().then(e=>e.streamMessenger.disconnect()),this._doPause()}_doConnect(){this.getWorker().then(e=>e.streamMessenger.connect()),this.resume()}_doClear(){this.getWorker().then(e=>e.streamMessenger.clear()),this._refreshInterval==null&&this.incrementSourceRefreshVersion()}_createClientOptions(){let e=super._createClientOptions(),t=this;return y(m({},e),{get container(){return t.featureContainer},setProperty:s=>{this.set(s.propertyName,s.value)}})}};r([n()],o.prototype,"pipelineConnectionStatus",void 0),r([n()],o.prototype,"pipelineErrorString",void 0),r([n({readOnly:!0})],o.prototype,"connectionError",null),r([n({readOnly:!0})],o.prototype,"_streamConnectionStatus",null),o=r([u("esri.views.2d.layers.StreamLayerView2D")],o);var z=o;export{z as default};
