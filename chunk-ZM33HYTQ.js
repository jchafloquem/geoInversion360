import{b as _,c as x}from"./chunk-P3Z62US6.js";import"./chunk-EAOA3IP2.js";import"./chunk-4ZJCWL5T.js";import"./chunk-CKGQR2CH.js";import"./chunk-LK52GLIE.js";import"./chunk-4INMWFSQ.js";import"./chunk-I46ARENO.js";import"./chunk-SRPI622Y.js";import"./chunk-B7IX6UFG.js";import"./chunk-OOE2LCNP.js";import"./chunk-IFCRPPYQ.js";import"./chunk-ZAQLF7TN.js";import"./chunk-Y5GQJM6D.js";import"./chunk-7WFRJSY3.js";import"./chunk-FUBITVJ7.js";import{b as h}from"./chunk-Y6HWUWZ3.js";import"./chunk-AQ74ANSJ.js";import"./chunk-5UCI4TUX.js";import"./chunk-SAOUSUZE.js";import"./chunk-PPFMRTTD.js";import"./chunk-IWJQ3PU6.js";import"./chunk-5QLB7ZJ7.js";import"./chunk-4HUAEW4D.js";import"./chunk-XWRPBDYS.js";import"./chunk-TCCAOREC.js";import"./chunk-BCREO4Q5.js";import"./chunk-SO6OJFOM.js";import"./chunk-DG5QI6E2.js";import"./chunk-TMZNSBQB.js";import"./chunk-ZGLJFDS6.js";import"./chunk-RSDQHAJX.js";import"./chunk-OFVMJORF.js";import"./chunk-2FYXACXP.js";import{b as y}from"./chunk-RP7XSKHE.js";import"./chunk-VV7MGXTC.js";import"./chunk-IXNVQC76.js";import"./chunk-LYPZUCFI.js";import"./chunk-5TSEU5EE.js";import"./chunk-VC35VCVT.js";import"./chunk-MT7BXRRQ.js";import"./chunk-NNKLK2DS.js";import"./chunk-VU5W7W6Y.js";import"./chunk-BRGZVJPZ.js";import{I as a}from"./chunk-Z5NXR7SL.js";import{S as m}from"./chunk-7JLWSSXP.js";import{a as r}from"./chunk-W3WDPWBE.js";import{a as S,b as $,q as C,y as F}from"./chunk-JKP4I6UL.js";import"./chunk-TZHKPIVH.js";import"./chunk-JPDAKIWT.js";import"./chunk-W6LY37E4.js";import{q as b}from"./chunk-BRWS572J.js";import"./chunk-AKNRR36C.js";import{g as v}from"./chunk-JEGVIFEP.js";var c=Symbol(),U=d=>{let e=class extends d{constructor(){super(...arguments),this.layerViews=new y,this._debouncedUpdate=F(()=>v(this,null,function*(){let{layer:i,parent:s}=this,o=s?.footprintLayerView,n=[],p=this._createQuery();if(p&&o){let{features:f}=yield o.queryFeatures(p);this.suspended||(n=f.map(w=>i.acquireLayer(w)))}this.removeHandles(c),this.addHandles(n,c)}))}get creatingLayerViews(){return this.view?.layerViewManager.isCreatingLayerViewsForLayer(this.layer)??!1}isUpdating(){return this.creatingLayerViews||this.layer.updating||this.layerViews.some(i=>i.updating)}enableLayerUpdates(){return $([this._updatingHandles.addWhen(()=>this.parent?.footprintLayerView?.dataUpdating===!1,()=>this.updateLayers()),this._updatingHandles.add(()=>[this.layer.maximumVisibleSublayers,this.layer.parent?.orderBy,this.parent?.footprintLayerView?.filter,this.parent?.footprintLayerView?.timeExtent,this.suspended],()=>this.updateLayers()),S(()=>this.removeHandles(c))])}updateLayers(){this.suspended?this.removeHandles(c):this._updatingHandles.addPromise(C(this._debouncedUpdate()).catch(i=>{b.getLogger(this).error(i)}))}_createQuery(){let i=this.parent?.footprintLayerView,s=this.layer?.parent;if(!i||!s||s.destroyed)return null;let{layer:{maximumVisibleSublayers:o},view:{scale:n}}=this;if(!o)return null;let{itemTypeField:p,itemSourceField:f,itemNameField:w,minScaleField:g,maxScaleField:V,objectIdField:H,orderBy:I}=s,A=h(`${g} IS NULL OR ${n} <= ${g} OR ${g} = 0`,`${V} IS NULL OR ${n} >= ${V}`),l=I?.find(u=>u.field&&!u.valueExpression),t=i.createQuery();if(t.returnGeometry=!1,t.num=o,t.outFields=[H,f,w],t.where=h(t.where,A),this.unsupportedItemTypes!=null){let u=`${p} NOT IN (${this.unsupportedItemTypes.map(O=>`'${O}'`)})`;t.where=h(t.where,u)}return l?.field&&(t.orderByFields=[`${l.field} ${l.order==="descending"?"DESC":"ASC"}`],t.outFields.push(l.field)),t}};return r([a({readOnly:!0})],e.prototype,"creatingLayerViews",null),r([a()],e.prototype,"layer",void 0),r([a()],e.prototype,"layerViews",void 0),r([a({readOnly:!0})],e.prototype,"unsupportedItemTypes",void 0),r([a()],e.prototype,"parent",void 0),r([a({readOnly:!0})],e.prototype,"isUpdating",null),e=r([m("esri.views.layers.CatalogDynamicGroupLayerView")],e),e};var L=class extends U(_(x)){constructor(){super(...arguments),this.unsupportedItemTypes=["Scene Service"],this.layerViews=new y}attach(){this.addAttachHandles([this.layerViews.on("after-changes",()=>this._updateStageChildren()),this.enableLayerUpdates()])}detach(){this.container.removeAllChildren()}update(d){this.updateLayers()}viewChange(){}moveEnd(){this.requestUpdate()}_updateStageChildren(){this.container.removeAllChildren(),this.layerViews.forEach((d,e)=>this.container.addChildAt(d.container,e))}};L=r([m("esri.views.2d.layers.CatalogDynamicGroupLayerView2D")],L);var ie=L;export{ie as default};
