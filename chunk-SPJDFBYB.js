import{d as p}from"./chunk-6NCXSKJD.js";import{K as u,N as o,h as a,t as v,u as d}from"./chunk-BRGZVJPZ.js";var f={mapserver:"MapServer",imageserver:"ImageServer",featureserver:"FeatureServer",knowledgegraphserver:"KnowledgeGraphServer",sceneserver:"SceneServer",streamserver:"StreamServer",vectortileserver:"VectorTileServer","3dtilesserver":"3DTilesServer",videoserver:"VideoServer"},m=Object.values(f),h=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/rest\\/services\\/(.+?)\\/(${m.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),y=new RegExp(`^((?:https?:)?\\/\\/\\S+?\\/([^/\\n]+)\\/(${m.join("|")}))(?:\\/(?:layers\\/)?(\\d+))?`,"i"),w=/(.*?)\/(?:layers\/)?(\d+)\/?$/i;function A(r){return h.test(r)}function S(r){if(r==null)return null;let e=a(r),s=e?.path.match(h)||e?.path.match(y);if(!s)return null;let[,t,n,l,i]=s,c=n.indexOf("/");return{title:g(c!==-1?n.slice(c+1):n),serverType:f[l.toLowerCase()],sublayer:i!=null&&i!==""?parseInt(i,10):null,url:{path:t}}}function I(r){let e=a(r).path.match(w);return e?{serviceUrl:e[1],sublayerId:Number(e[2])}:null}function g(r){return(r=r.replaceAll(/\s*[/_]+\s*/g," "))[0].toUpperCase()+r.slice(1)}function T(r,e){let s=[];if(r){let t=S(r);t!=null&&t.title&&s.push(t.title)}if(e){let t=g(e);s.push(t)}if(s.length===2){if(s[0].toLowerCase().includes(s[1].toLowerCase()))return s[0];if(s[1].toLowerCase().includes(s[0].toLowerCase()))return s[1]}return s.join(" - ")}function W(r){let e=d(r,!0);return!!e&&(e=e.toLowerCase(),e.endsWith(".arcgis.com")&&(e.startsWith("services")||e.startsWith("tiles")||e.startsWith("features")))}function j(r,e){return r&&u(o(r,e))}function O(r){let{url:e}=r;if(!e)return{url:e};e=o(e,r.logger);let s=a(e),t=S(s.path),n;if(t!=null)t.sublayer!=null&&r.layer.layerId==null&&(n=t.sublayer),e=t.url.path;else if(r.nonStandardUrlAllowed){let l=I(s.path);l!=null&&(e=l.serviceUrl,n=l.sublayerId)}return{url:u(e),layerId:n}}function x(r,e,s,t,n){p(e,t,"url",n),t.url&&r.layerId!=null&&(t.url=v(t.url,s,r.layerId.toString()))}function G(r){if(!r)return!1;let e=r.toLowerCase(),s=e.includes("/services/"),t=e.includes("/mapserver/wmsserver"),n=e.includes("/imageserver/wmsserver"),l=e.includes("/wmsserver");return s&&(t||n||l)}export{A as a,S as b,I as c,g as d,T as e,W as f,j as g,O as h,x as i,G as j};
