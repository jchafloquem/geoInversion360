import{a as K}from"./chunk-7QY3BMVN.js";import{a as G}from"./chunk-NWPYI2UP.js";import{a as N}from"./chunk-TNPL7MIN.js";import{m as H,n as J}from"./chunk-BYQI7UDX.js";import{b as Q,c as B,d as X,e as D}from"./chunk-IWJQ3PU6.js";import{b as C}from"./chunk-TCCAOREC.js";import{a as $}from"./chunk-TZHKPIVH.js";import{q as U,s as w}from"./chunk-BRWS572J.js";function p(e,o){return e?o?4:3:o?3:2}var x=()=>U.getLogger("esri.layers.graphics.featureConversionUtils"),re={esriGeometryPoint:0,esriGeometryPolyline:2,esriGeometryPolygon:3,esriGeometryMultipoint:0,esriGeometryEnvelope:0},me=(e,o,r,t,s,n)=>{e[r]=s,e[r+1]=n},W=(e,o,r,t,s,n)=>{e[r]=s,e[r+1]=n,e[r+2]=o[t+2]},he=(e,o,r,t,s,n)=>{e[r]=s,e[r+1]=n,e[r+2]=o[t+3]},de=(e,o,r,t,s,n)=>{e[r]=s,e[r+1]=n,e[r+2]=o[t+2],e[r+3]=o[t+3]};function Y(e,o,r,t){if(e){if(r)return o&&t?de:W;if(o&&t)return he}else if(o&&t)return W;return me}function E({scale:e,translate:o},r){return Math.round((r-o[0])/e[0])}function V({scale:e,translate:o},r){return Math.round((o[1]-r)/e[1])}function O({scale:e,translate:o},r,t){return r*e[t]+o[t]}function Re(e,o,r){return e?o?r?_(e):k(e):r?j(e):q(e):null}function q(e){let o=e.coords;return{x:o[0],y:o[1]}}function te(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e}function k(e){let o=e.coords;return{x:o[0],y:o[1],z:o[2]}}function ge(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.z,e}function j(e){let o=e.coords;return{x:o[0],y:o[1],m:o[2]}}function ye(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.m,e}function _(e){let o=e.coords;return{x:o[0],y:o[1],z:o[2],m:o[3]}}function pe(e,o){return e.coords[0]=o.x,e.coords[1]=o.y,e.coords[2]=o.z,e.coords[3]=o.m,e}function Fe(e,o,r,t){let s=q;r&&t?s=_:r?s=k:t&&(s=j);for(let n of o){let{geometry:u,attributes:l}=n,c=u!=null?s(u):null;e.push({attributes:l,geometry:c})}return e}function A(e,o){return e&&o?pe:e?ge:o?ye:te}function Ie(e,o,r,t,s){let n=A(r,t);for(let{geometry:u,attributes:l}of o){let c=u!=null?n(new N,u):null;e.push(new G(c,l,null,s?l[s]:void 0))}return e}function Me(e,o,r=A(o.z!=null,o.m!=null)){return r(e,o)}function be(e,o,r,t){for(let{geometry:s,attributes:n}of o)e.push({attributes:n,geometry:s!=null?ne(s,r,t):null});return e}function ne(e,o,r){if(e==null)return null;let t=p(o,r),s=[];for(let n=0;n<e.coords.length;n+=t){let u=[];for(let l=0;l<t;l++)u.push(e.coords[n+l]);s.push(u)}return o?r?{points:s,hasZ:o,hasM:r}:{points:s,hasZ:o}:r?{points:s,hasM:r}:{points:s}}function Te(e,o,r,t,s){let n=p(r,t);for(let{geometry:u,attributes:l}of o){let c=u!=null?se(new N,u,n):null;e.push(new G(c,l,null,s?l[s]:void 0))}return e}function se(e,o,r=p(o.hasZ,o.hasM)){e.lengths[0]=o.points.length;let t=e.coords,s=0;for(let n of o.points)for(let u=0;u<r;u++)t[s++]=n[u];return e}function Ne(e,o,r,t){for(let{geometry:s,attributes:n}of o)e.push({attributes:n,geometry:s!=null?ue(s,r,t):null});return e}function ue(e,o,r){if(!e)return null;let t=p(o,r),{coords:s,lengths:n}=e,u=[],l=0;for(let c of n){let i=[];for(let a=0;a<c;a++){let f=[];for(let m=0;m<t;m++)f.push(s[l++]);i.push(f)}u.push(i)}return o?r?{paths:u,hasZ:o,hasM:r}:{paths:u,hasZ:o}:r?{paths:u,hasM:r}:{paths:u}}function ve(e,o,r,t,s){let n=p(r,t);for(let{geometry:u,attributes:l,centroid:c}of o){let i=u!=null?le(new N,u,n):null,a=c!=null?Me(new N,c):null;e.push(new G(i,l,a,s?l[s]:void 0))}return e}function le(e,o,r=p(o.hasZ,o.hasM)){let{lengths:t,coords:s}=e,n=0;for(let u of o.paths){for(let l of u)for(let c=0;c<r;c++)s[n++]=l[c];t.push(u.length)}return e}function Ge(e,o,r,t){for(let{geometry:s,attributes:n,centroid:u}of o){let l=s!=null?ie(s,r,t):null;if(u!=null){let c=q(u);e.push({attributes:n,centroid:c,geometry:l})}else e.push({attributes:n,geometry:l})}return e}function ie(e,o,r){if(!e)return null;let t=p(o,r),{coords:s,lengths:n}=e,u=[],l=0;for(let c of n){let i=[];for(let a=0;a<c;a++){let f=[];for(let m=0;m<t;m++)f.push(s[l++]);i.push(f)}u.push(i)}return o?r?{rings:u,hasZ:o,hasM:r}:{rings:u,hasZ:o}:r?{rings:u,hasM:r}:{rings:u}}function we(e,o,r,t,s){for(let{geometry:n,centroid:u,attributes:l}of o){let c=n!=null?ce(new N,n,r,t):null,i=s?l[s]:void 0;u!=null?e.push(new G(c,l,te(new N,u),i)):e.push(new G(c,l,null,i))}return e}function ce(e,o,r=o.hasZ,t=o.hasM){return Pe(e,o.rings,r,t)}function Pe(e,o,r,t){let s=p(r,t),{lengths:n,coords:u}=e,l=0;v(e);for(let c of o){for(let i of c)for(let a=0;a<s;a++)u[l++]=i[a];n.push(c.length)}return e}var P=[],z=[];function Ue(e,o,r,t,s){P[0]=e;let[n]=ae(z,P,o,r,t,s);return T(P),T(z),n}function ae(e,o,r,t,s,n){if(T(e),!r){for(let u of o){let l=n?u.attributes[n]:void 0;e.push(new G(null,u.attributes,null,l))}return e}switch(r){case"esriGeometryPoint":return Ie(e,o,t,s,n);case"esriGeometryMultipoint":return Te(e,o,t,s,n);case"esriGeometryPolyline":return ve(e,o,t,s,n);case"esriGeometryPolygon":return we(e,o,t,s,n);default:x().error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${r}'`)),T(e)}return e}function $e(e,o,r,t){z[0]=e,fe(P,z,o,r,t);let s=P[0];return T(P),T(z),s}function Ce(e,o,r){if(e==null)return null;let t=new N;return"hasZ"in e&&o==null&&(o=e.hasZ),"hasM"in e&&r==null&&(r=e.hasM),B(e)?A(o??e.z!=null,r??e.m!=null)(t,e):D(e)?ce(t,e,o,r):X(e)?le(t,e,p(o,r)):Q(e)?se(t,e,p(o,r)):void x().error("convertFromGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${e}'`))}function ze(e,o,r,t){let s=e&&("coords"in e?e:e.geometry);if(s==null)return null;switch(o){case"esriGeometryPoint":{let n=q;return r&&t?n=_:r?n=k:t&&(n=j),n(s)}case"esriGeometryMultipoint":return ne(s,r,t);case"esriGeometryPolyline":return ue(s,r,t);case"esriGeometryPolygon":return ie(s,r,t);default:return x().error("convertToGeometry:unknown-geometry",new w(`Unable to parse unknown geometry type '${o}'`)),null}}function xe(e,o){for(let r of o)e.push({attributes:r.attributes});return e}function fe(e,o,r,t,s){if(T(e),r==null)return xe(e,o);switch(r){case"esriGeometryPoint":return Fe(e,o,t,s);case"esriGeometryMultipoint":return be(e,o,t,s);case"esriGeometryPolyline":return Ne(e,o,t,s);case"esriGeometryPolygon":return Ge(e,o,t,s);default:x().error("convertToFeatureSet:unknown-geometry",new w(`Unable to parse unknown geometry type '${r}'`))}return e}function Qe(e){let{objectIdFieldName:o,spatialReference:r,transform:t,fields:s,hasM:n,hasZ:u,features:l,geometryType:c,exceededTransferLimit:i,uniqueIdField:a,queryGeometry:f,queryGeometryType:m}=e,h={features:fe([],l,c,u,n),fields:s,geometryType:c,objectIdFieldName:o,spatialReference:r,uniqueIdField:a,queryGeometry:ze(f,m,!1,!1)};return t&&(h.transform=t),i&&(h.exceededTransferLimit=i),n&&(h.hasM=n),u&&(h.hasZ=u),h}function Be(e,o){let r=new K,{hasM:t,hasZ:s,features:n,objectIdFieldName:u,spatialReference:l,geometryType:c,exceededTransferLimit:i,transform:a,fields:f}=e;return f&&(r.fields=f),r.geometryType=c??null,r.objectIdFieldName=u??o??null,r.spatialReference=l??null,r.objectIdFieldName?(n&&ae(r.features,n,c,s,t,r.objectIdFieldName),i&&(r.exceededTransferLimit=i),t&&(r.hasM=t),s&&(r.hasZ=s),a&&(r.transform=a),r):(x().error(new w("optimized-features:invalid-objectIdFieldName","objectIdFieldName is missing")),r)}function Xe(e){let{transform:o,features:r,hasM:t,hasZ:s}=e;if(!o)return e;for(let n of r)n.geometry!=null&&oe(n.geometry,n.geometry,t,s,o),n.centroid!=null&&oe(n.centroid,n.centroid,t,s,o);return e.transform=null,e}function De(e,o){let{geometryType:r,features:t,hasM:s,hasZ:n}=o;if(!e)return o;for(let u=0;u<t.length;u++){let l=t[u],c=l.weakClone();c.geometry=new N,ee(c.geometry,l.geometry,s,n,r,e),l.centroid&&(c.centroid=new N,ee(c.centroid,l.centroid,s,n,"esriGeometryPoint",e)),t[u]=c}return o.transform=e,o}function ee(e,o,r,t,s,n,u=r,l=t){if(v(e),!o?.coords.length)return null;let c=re[s],{coords:i,lengths:a}=o,f=p(r,t),m=p(r&&u,t&&l),h=Y(r,t,u,l);if(!a.length)return h(e.coords,i,0,0,E(n,i[0]),V(n,i[1])),v(e,f,0),e;let d,y,I,M,F=0,g=0,b=g;for(let L of a){if(L<c)continue;let Z=0;g=b,I=d=E(n,i[F]),M=y=V(n,i[F+1]),h(e.coords,i,g,F,I,M),Z++,F+=f,g+=m;for(let R=1;R<L;R++,F+=f)I=E(n,i[F]),M=V(n,i[F+1]),I===d&&M===y||(h(e.coords,i,g,F,I-d,M-y),g+=m,Z++,d=I,y=M);Z>=c&&(e.lengths.push(Z),b=g)}return T(e.coords,b),e.coords.length?e:null}function He(e,o,r,t,s,n,u=r,l=t){if(v(e),!o?.coords.length)return null;let c=re[s],{coords:i,lengths:a}=o,f=p(r,t),m=p(r&&u,t&&l),h=Y(r,t,u,l);if(!a.length)return h(e.coords,i,0,0,i[0],i[1]),v(e,f,0),e;let d=0,y=n*n;for(let I of a){if(I<c){d+=I*f;continue}let M=e.coords.length/m,F=d,g=d+(I-1)*f;h(e.coords,i,e.coords.length,F,i[F],i[F+1]),S(e.coords,i,f,y,h,F,g),h(e.coords,i,e.coords.length,g,i[g],i[g+1]);let b=e.coords.length/m-M;b>=c?e.lengths.push(b):T(e.coords,M*m),d+=I*f}return e.coords.length?e:null}function Ze(e,o,r,t){let s=e[o],n=e[o+1],u=e[r],l=e[r+1],c=e[t],i=e[t+1],a=u,f=l,m=c-a,h=i-f;if(m!==0||h!==0){let d=((s-a)*m+(n-f)*h)/(m*m+h*h);d>1?(a=c,f=i):d>0&&(a+=m*d,f+=h*d)}return m=s-a,h=n-f,m*m+h*h}function S(e,o,r,t,s,n,u){let l,c=t,i=0;for(let a=n+r;a<u;a+=r)l=Ze(o,a,n,u),l>c&&(i=a,c=l);c>t&&(i-n>r&&S(e,o,r,t,s,n,i),s(e,o,e.length,i,o[i],o[i+1]),u-i>r&&S(e,o,r,t,s,i,u))}function Je(e,o,r,t){if(!o?.coords?.length)return null;let s=p(r,t),n=Number.POSITIVE_INFINITY,u=Number.POSITIVE_INFINITY,l=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;if(o&&o.coords){let i=o.coords;for(let a=0;a<i.length;a+=s){let f=i[a],m=i[a+1];n=Math.min(n,f),l=Math.max(l,f),u=Math.min(u,m),c=Math.max(c,m)}}return J(e)?H(e,n,u,l,c):C(n,u,l,c,e),e}function oe(e,o,r,t,s){let{coords:n,lengths:u}=o,l=p(r,t);if(!n.length)return e!==o&&v(e),e;$(s);let{originPosition:c,scale:i,translate:a}=s,f=Ee;f.originPosition=c;let m=f.scale;m[0]=i[0]??1,m[1]=-(i[1]??1),m[2]=i[2]??1,m[3]=i[3]??1;let h=f.translate;if(h[0]=a[0]??0,h[1]=a[1]??0,h[2]=a[2]??0,h[3]=a[3]??0,!u.length){for(let y=0;y<l;++y)e.coords[y]=O(f,n[y],y);return e!==o&&v(e,l,0),e}let d=0;for(let y=0;y<u.length;y++){let I=u[y];e.lengths[y]=I;for(let g=0;g<l;++g)e.coords[d+g]=O(f,n[d+g],g);let M=e.coords[d],F=e.coords[d+1];d+=l;for(let g=1;g<I;g++,d+=l){M+=n[d]*m[0],F+=n[d+1]*m[1],e.coords[d]=M,e.coords[d+1]=F;for(let b=2;b<l;++b)e.coords[d+b]=O(f,n[d+b],b)}}return e!==o&&v(e,n.length,u.length),e}function Ke(e,o,r,t,s,n){if(v(e),e.lengths.push(...o.lengths),r===s&&t===n)for(let u=0;u<o.coords.length;u++)e.coords.push(o.coords[u]);else{let u=p(r,t),l=Y(r,t,s,n),c=o.coords;for(let i=0;i<c.length;i+=u)l(e.coords,c,e.coords.length,i,c[i],c[i+1])}return e}function qe(e,o,r,t){let s=0,n=e[t*o],u=e[t*(o+1)];for(let l=1;l<r;l++){let c=n+e[t*(o+l)],i=u+e[t*(o+l)+1],a=(c-n)*(i+u);n=c,u=i,s+=a}return .5*s}function We(e,o){let{coords:r,lengths:t}=e,s=0,n=0;for(let u=0;u<t.length;u++){let l=t[u];n+=qe(r,s,l,o),s+=l}return Math.abs(n)}function v(e,o=0,r=0){T(e.lengths,r),T(e.coords,o)}function T(e,o=0){e.length!==o&&(e.length=o)}var Ee={originPosition:"lowerLeft",scale:[1,1,1,1],translate:[0,0,0,0]};export{E as a,V as b,Re as c,Me as d,ne as e,ue as f,ie as g,ce as h,Pe as i,Ue as j,ae as k,$e as l,Ce as m,ze as n,Qe as o,Be as p,Xe as q,De as r,ee as s,He as t,Je as u,oe as v,Ke as w,We as x};
