import{a as w,c as de,d as le,e as ce,f as k}from"./chunk-72VQRINQ.js";import{a as te,b as re,c as oe,d as N,e as se}from"./chunk-R2RE6SI6.js";import{a as Z}from"./chunk-V2KSICSA.js";import{a as L,b as X,h as Y}from"./chunk-2FYXACXP.js";import{b as J}from"./chunk-FX2VBPAM.js";import{a as G}from"./chunk-VV7MGXTC.js";import{a as Q}from"./chunk-LYPZUCFI.js";import{c as q}from"./chunk-HFQFGALU.js";import{a as ee}from"./chunk-VC35VCVT.js";import{a as K}from"./chunk-NNKLK2DS.js";import{b as ae}from"./chunk-F4EX5NX6.js";import{a as ne,b as ie}from"./chunk-MDAB6L5Y.js";import{b as S,c as j}from"./chunk-OMNN7QFV.js";import{q as W}from"./chunk-BRGZVJPZ.js";import{D as U,I as m,a as H}from"./chunk-Z5NXR7SL.js";import{S as V,n as M}from"./chunk-7JLWSSXP.js";import{a as h}from"./chunk-W3WDPWBE.js";import{d as D,e as $,l as I,y as z}from"./chunk-JKP4I6UL.js";import{b as A}from"./chunk-TZHKPIVH.js";import{b as x,q as E}from"./chunk-BRWS572J.js";import{a as y,g as C}from"./chunk-JEGVIFEP.js";function pe(e){return typeof e=="string"?document.getElementById(e):e??null}function xe(e){for(;e.hasChildNodes();)e.removeChild(e.firstChild)}function He(e,t){let r=t.parentNode;r&&r.insertBefore(e,t)}function Me(e,t){for(;;){let r=e.firstChild;if(!r)break;t.appendChild(r)}}var De=typeof Element.prototype.closest=="function"?(e,t)=>e.closest(t):(e,t)=>{let r=e;do{if(r.matches(t))return r;r=r.parentElement}while(r!==null&&r.nodeType===1);return null};var he={handleInterceptedEvent:(e,t,r,o)=>(e.scheduleRender(),t.properties[`on${o.type}`].apply(t.properties.bind||r,[o]))};var Ne={namespace:void 0,performanceLogger:()=>{},eventHandlerInterceptor:void 0,styleApplyer:(e,t,r)=>{t.charAt(0)==="-"?e.style.setProperty(t,r):e.style[t]=r}},me=e=>y(y({},Ne),e);var Re=(e,t)=>{let r=[];for(;e&&e!==t;)r.push(e),e=e.parentNode;return r},Ae=(e,t)=>e.find(t),ue=(e,t,r=!1)=>{let o=e;return t.forEach((l,i)=>{let a=o?.children?Ae(o.children,n=>n.domNode===l):void 0;r&&!a&&i!==t.length-1||(o=a)}),o},fe=e=>{let t,r=y(y({},he),e),o=me(r),l=o.performanceLogger,i,a=!0,n=!1,s=[],u=[],f=(p,d,T)=>{let v;o.eventHandlerInterceptor=(Fe,Te,Be,Oe)=>function(_){let P;l("domEvent",_);let R=Re(_.currentTarget,v.domNode),Ce=R.some(b=>customElements.get(b?.tagName?.toLowerCase()));if(_.eventPhase===Event.CAPTURING_PHASE||!Ce)R.reverse(),P=ue(v.getLastRender(),R);else{let b=_.composedPath(),Ee=b.slice(b.indexOf(_.currentTarget),b.indexOf(v.domNode)).reverse();P=ue(v.getLastRender(),Ee,!0)}let O;return P&&(O=r.handleInterceptedEvent(t,P,this,_)),l("domEventProcessed",_),O},r.postProcessProjectionOptions?.(o);let B=T();v=p(d,B,o),o.eventHandlerInterceptor=void 0,s.push(v),u.push(T),r.afterFirstVNodeRendered&&r.afterFirstVNodeRendered(v,B)},g=()=>{if(i=void 0,a){a=!1,l("renderStart",void 0);for(let p=0;p<s.length;p++){let d=u[p]();l("rendered",void 0),s[p].update(d),l("patched",void 0)}l("renderDone",void 0),a=!0}};return r.modifyDoRenderImplementation&&(g=r.modifyDoRenderImplementation(g,s,u)),t={renderNow:g,scheduleRender:()=>{i||n||(i=requestAnimationFrame(g))},stop:()=>{i&&(cancelAnimationFrame(i),i=void 0),n=!0},resume:()=>{n=!1,a=!0,t.scheduleRender()},append:(p,d)=>{f(w.append,p,d)},insertBefore:(p,d)=>{f(w.insertBefore,p,d)},merge:(p,d)=>{f(w.merge,p,d)},replace:(p,d)=>{f(w.replace,p,d)},detach:p=>{for(let d=0;d<u.length;d++)if(u[d]===p)return u.splice(d,1),s.splice(d,1)[0];throw new Error("renderFunction was not found")}},t};function ge(){let{classList:e}=document.body,t=window.matchMedia("(prefers-color-scheme: dark)").matches,r=()=>e.contains(ie)||e.contains(ne)&&t?"dark":"light",o=a=>document.body.dispatchEvent(new CustomEvent("calciteModeChange",{bubbles:!0,detail:{mode:a}})),l=a=>{i!==a&&o(a),i=a},i=r();o(i),window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",a=>l(a.matches?"dark":"light")),new MutationObserver(()=>l(r())).observe(document.body,{attributes:!0,attributeFilter:["class"]})}function Ie(){typeof window<"u"&&typeof location<"u"&&typeof document<"u"&&window.location===location&&window.document===document&&(document.readyState==="interactive"?ge():document.addEventListener("DOMContentLoaded",()=>ge(),{once:!0})),ae()}var Le=Ie;Le();var ye;function ve(){try{S(".")}catch{j(W(K(ye)))}}function at(e){let t=[];for(let r of Object.keys(e))customElements.get(`calcite-${r}`)||t.push(e[r]?.());return t.length>0?Promise.all(t):null}ye="components/assets";var _e=new Set;function be(e){_e.add(e),e.finally(()=>_e.delete(e))}var we,Se="esri.widgets.Widget",je=0;function Pe(e,t){let r=Object.prototype.hasOwnProperty;for(let o in t)r.call(t,o)&&r.call(e,o)&&(e[o]!=null&&t[o]!=null&&typeof e[o]=="object"&&typeof t[o]=="object"?Pe(e[o],t[o]):e[o]=t[o]);return e}var ke=fe({postProcessProjectionOptions(e){let t=e.eventHandlerInterceptor,r=/capture$/i;e.eventHandlerInterceptor=(o,l,i,a)=>{let n=t?.(o,l,i,a),s=r.test(o);if(!((o=o.replace(r,"")).toLowerCase()in i)||s){let u=o[2].toLowerCase()+o.slice(3),f=d=>n?.call(i,d);i.addEventListener(u,f,s);let g=()=>i.removeEventListener(u,f,s),p=a.afterRemoved;a.afterRemoved=d=>{p?.(d),g()}}return n}},handleInterceptedEvent(e,t,r,o){let{eventPhase:l,type:i}=o,a=l===Event.CAPTURING_PHASE,n=`on${i}${a?"capture":""}`,s=t.properties;(s&&n in s||(n=`on${i[0].toUpperCase()}${i.slice(1)}${a?"Capture":""}`,s&&n in s))&&(te(),e.scheduleRender(),s[n].call(s.bind||r,o))}}),F=!1,c=class extends Q(G.EventedAccessor){constructor(e,t){super(e,t),this._attached=!1,this._projector=ke,this._readyForTrueRender=!1,this.key=this,this.autoRenderingEnabled=!0,this._loadLocale=z(()=>C(this,null,function*(){if(this._messageBundleProps?.length){let n=yield Promise.allSettled(this._messageBundleProps.map(f=>C(this,[f],function*({bundlePath:s,propertyName:u}){if(this.destroyed)return;let g=yield J(s);this.uiStrings&&Object.keys(this.uiStrings)&&(g=Pe(x(g),this.uiStrings)),this[u]=g})));if(this.destroyed)return;for(let s of n)s.status==="rejected"&&E.getLogger(this).error("widget-intl:locale-error",this.declaredClass,s.reason)}yield this.loadLocale()})),ve();let r="esri-widget-uid-"+Z(),o=this.render.bind(this);this._trackingTarget=new U(()=>{this.autoRenderingEnabled&&this.scheduleRender()});let l=()=>({vnodeSelector:"div",properties:{key:`${r}-hidden`,class:"",styles:{display:"none"}},domNode:null,children:void 0,text:void 0}),i=()=>{if(!this._readyForTrueRender||this.destroyed)return null;let n=o()??l(),s=n.properties??={};if(s.key??=r,k(n.vnodeSelector)){if(!this.visible)return l()}else this.visible?s.styles||(s.styles={}):(s.class="",s.styles={display:"none"}),s.styles.display??="";let u=0;return n.children?.forEach(f=>{k(f.vnodeSelector)||(f.properties??={},f.properties.key??=`${this.id}--${u++}`)}),ce(this,n)};this.render=()=>{if(F)return i();let n=re(this)??null;if(n)return n;this._trackingTarget.clear(),F=!0;try{n=M(this._trackingTarget,i)}catch(s){throw E.getLogger(this).error(s),s}finally{F=!1}return n&&oe(this,n),n};let a=this.beforeFirstRender();a?this._resourcesFetch=a.then(()=>{this._readyForTrueRender=!0,this._postInitialize()}):(this._resourcesFetch=Promise.resolve().then(()=>{this._postInitialize()}),this._readyForTrueRender=!0),this.addResolvingPromise(this._resourcesFetch),be(this._resourcesFetch)}normalizeCtorArgs(e,t){let r=y({},e);return t&&(r.container=t),r}postInitialize(){}beforeFirstRender(){let e=this.loadDependencies();return this._messageBundleProps?.length||e?Promise.all([e,this._loadLocale()]).then(()=>{}).catch(I):null}loadDependencies(){return null}loadLocale(){return null}destroy(){this.destroyed||(A(this._trackingTarget),A(this.viewModel),this._detach(this.container),this._set("container",null),this._emitter.clear(),this.render=()=>null,this._projector=null,N(this))}set container(e){this._get("container")||this._set("container",e)}castContainer(e){return pe(e)}get domNode(){return this.container}set domNode(e){this.container=e}get icon(){return null}set icon(e){this._overrideIfSome("icon",e)}get id(){return this._get("id")||this.container?.id||Date.now().toString(16)+"-widget-"+je++}set id(e){e&&this._set("id",e)}get label(){return this.declaredClass.split(".").pop()}set label(e){this._overrideIfSome("label",e)}get renderable(){return this._resourcesFetch}get visible(){return this._get("visible")}set visible(e){this._set("visible",e)}get[(we=de,le)](){return{projector:this._projector}}render(){throw new Error("not implemented")}scheduleRender(){this.destroyed||(N(this),this._projector.scheduleRender())}own(e){H(E.getLogger(this),"`Widget.own()` is deprecated in favor of 'Widget.addHandles()'",{replacement:"Widget.addHandles()",version:"4.28"}),this.addHandles(e)}classes(...e){return se.apply(this,e)}renderNow(){N(this),this._projector.renderNow()}_postInitialize(){if(this.destroyed)return;this.scheduleRender(),this._delegatedEventNames?.length&&this.addHandles(L(()=>this.viewModel,(t,r)=>{r&&this.removeHandles("delegated-events"),t&&D(t)&&this.addHandles(this._delegatedEventNames.map(o=>$(t,o,l=>{this.emit(o,l)})),"delegated-events")},Y)),this.postInitialize();let e=()=>C(this,null,function*(){yield this._loadLocale().catch(I),this.scheduleRender()});this.addHandles([q(e),L(()=>this.uiStrings,e),X(()=>this.container,t=>{this.destroyed||this._attach(t)},{initial:!0,once:!0})])}_attach(e){e&&(this._projector.merge(e,this.render),this._attached=!0)}_detach(e){this._attached&&(this._projector.detach(this.render),this._attached=!1),e?.parentNode?.removeChild(e)}};c[we]=!0,h([m()],c.prototype,"_readyForTrueRender",void 0),h([m({value:null})],c.prototype,"container",null),h([ee("container")],c.prototype,"castContainer",null),h([m()],c.prototype,"icon",null),h([m()],c.prototype,"id",null),h([m()],c.prototype,"label",null),h([m()],c.prototype,"renderable",null),h([m()],c.prototype,"uiStrings",void 0),h([m()],c.prototype,"viewModel",void 0),h([m({value:!0})],c.prototype,"visible",null),h([m()],c.prototype,"key",void 0),h([m()],c.prototype,"children",void 0),h([m()],c.prototype,"afterCreate",void 0),h([m()],c.prototype,"afterUpdate",void 0),h([m()],c.prototype,"afterRemoved",void 0),c=h([V(Se)],c);var Ht=c;function zt(e){return(t,r)=>{t.hasOwnProperty("_messageBundleProps")||(t._messageBundleProps=t._messageBundleProps?t._messageBundleProps.slice():[]),t._messageBundleProps.push({bundlePath:e,propertyName:r})}}export{pe as a,xe as b,He as c,Me as d,at as e,Ht as f,zt as g};
