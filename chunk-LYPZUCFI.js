import{L as p}from"./chunk-Z5NXR7SL.js";import{S as h}from"./chunk-7JLWSSXP.js";import{a as o}from"./chunk-W3WDPWBE.js";import{g as _,p as a,z as l}from"./chunk-JKP4I6UL.js";var i;(function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"})(i||(i={}));var n=class{constructor(){this._resolver=l(),this._status=i.PENDING,this._resolvingPromises=[],this._resolver.promise.then(()=>{this._status=i.RESOLVED,this._cleanUp()},()=>{this._status=i.REJECTED,this._cleanUp()}),this.promise=this._resolver.promise}destroy(){this._cleanUp()}addResolvingPromise(r){this._resolvingPromises.push(r),this._tryResolve()}isResolved(){return this._status===i.RESOLVED}isRejected(){return this._status===i.REJECTED}isFulfilled(){return this._status!==i.PENDING}abort(){this._resolver.reject(_())}_cleanUp(){this._allPromise=null,this._resolvingPromises=null}_tryResolve(){if(this.isFulfilled())return;let r=l(),s=[...this._resolvingPromises,r.promise],t=this._allPromise=Promise.all(s);t.then(()=>{this.isFulfilled()||this._allPromise!==t||this._resolver.resolve()},m=>{this.isFulfilled()||this._allPromise!==t||a(m)||this._resolver.reject(m)}),r.resolve()}},P=e=>{let r=class extends e{constructor(...s){super(...s),this._promiseProps=new n,this.addResolvingPromise(Promise.resolve())}destroy(){this._promiseProps.destroy()}isResolved(){return this._promiseProps.isResolved()}isRejected(){return this._promiseProps.isRejected()}isFulfilled(){return this._promiseProps.isFulfilled()}when(s,t){return this._promiseProps.promise.then(()=>this).then(s,t)}catch(s){return this.when(null,s)}addResolvingPromise(s){s&&!this._promiseProps.isFulfilled()&&this._promiseProps.addResolvingPromise("_promiseProps"in s?s.when():s)}};return r=o([h("esri.core.Promise")],r),r},u=class extends P(p){};u=o([h("esri.core.Promise")],u);export{P as a,u as b};
