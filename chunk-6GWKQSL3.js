import{a as y}from"./chunk-C7VU6XKS.js";import{d as u,g as l}from"./chunk-JEGVIFEP.js";var S=new Set(["Catalog Layer","Feature Layer","Oriented Imagery Layer"]);function w(e,a){return l(this,null,function*(){let o=a||{},{loadContext:t}=o,r=u(o,["loadContext"]),n=t?yield t.fetchServiceMetadata(e,r):yield y(e,r);L(n),f(n);let s={serviceJSON:n};if((n.currentVersion??0)<10.5)return s;let i=`${e}/layers`,c=t?yield t.fetchServiceMetadata(i,r):yield y(i,r);return L(c),f(c),s.layersJSON={layers:c.layers,tables:c.tables},s})}function b(e){let{type:a}=e;return!!a&&S.has(a)}function h(e){return e.type==="Table"}function f(e){e.layers=e.layers?.filter(b),e.tables=e.tables?.filter(h)}function d(e){e.type||="Feature Layer"}function g(e){e.type||="Table"}function L(e){e.layers?.forEach(d),e.tables?.forEach(g)}function F(e){switch(e){case"Feature Layer":case"Table":return"FeatureLayer";case"Oriented Imagery Layer":return"OrientedImageryLayer";case"Catalog Layer":return"CatalogLayer"}return"FeatureLayer"}export{w as a,F as b};
