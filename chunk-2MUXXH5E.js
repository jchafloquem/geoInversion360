import{a as E,b as W,c as X,d as N,e as A,f as Z,l as _}from"./chunk-P454QITB.js";import{a as Q}from"./chunk-F4EX5NX6.js";import{a as z,b as J}from"./chunk-JEGVIFEP.js";function ee(o,a){var u=Object.keys(o);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(o);a&&(i=i.filter(function(b){return Object.getOwnPropertyDescriptor(o,b).enumerable})),u.push.apply(u,i)}return u}function te(o){for(var a=1;a<arguments.length;a++){var u=arguments[a]!=null?arguments[a]:{};a%2?ee(Object(u),!0).forEach(function(i){se(o,i,u[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(u)):ee(Object(u)).forEach(function(i){Object.defineProperty(o,i,Object.getOwnPropertyDescriptor(u,i))})}return o}function se(o,a,u){return a=fe(a),a in o?Object.defineProperty(o,a,{value:u,enumerable:!0,configurable:!0,writable:!0}):o[a]=u,o}function ce(o,a){if(typeof o!="object"||o===null)return o;var u=o[Symbol.toPrimitive];if(u!==void 0){var i=u.call(o,a||"default");if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(a==="string"?String:Number)(o)}function fe(o){var a=ce(o,"string");return typeof a=="symbol"?a:String(a)}var ae={activateTrap:function(a,u){if(a.length>0){var i=a[a.length-1];i!==u&&i.pause()}var b=a.indexOf(u);b===-1||a.splice(b,1),a.push(u)},deactivateTrap:function(a,u){var i=a.indexOf(u);i!==-1&&a.splice(i,1),a.length>0&&a[a.length-1].unpause()}},le=function(a){return a.tagName&&a.tagName.toLowerCase()==="input"&&typeof a.select=="function"},de=function(a){return a?.key==="Escape"||a?.key==="Esc"||a?.keyCode===27},C=function(a){return a?.key==="Tab"||a?.keyCode===9},ve=function(a){return C(a)&&!a.shiftKey},be=function(a){return C(a)&&a.shiftKey},ne=function(a){return setTimeout(a,0)},re=function(a,u){var i=-1;return a.every(function(b,s){return u(b)?(i=s,!1):!0}),i},B=function(a){for(var u=arguments.length,i=new Array(u>1?u-1:0),b=1;b<u;b++)i[b-1]=arguments[b];return typeof a=="function"?a.apply(void 0,i):a},j=function(a){return a.target.shadowRoot&&typeof a.composedPath=="function"?a.composedPath()[0]:a.target},pe=[],me=function(a,u){var i=u?.document||document,b=u?.trapStack||pe,s=te({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:ve,isKeyBackward:be},u),n={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},g,h=function(t,e,r){return t&&t[e]!==void 0?t[e]:s[r||e]},T=function(t,e){var r=typeof e?.composedPath=="function"?e.composedPath():void 0;return n.containerGroups.findIndex(function(c){var f=c.container,d=c.tabbableNodes;return f.contains(t)||r?.includes(f)||d.find(function(v){return v===t})})},D=function(t){var e=s[t];if(typeof e=="function"){for(var r=arguments.length,c=new Array(r>1?r-1:0),f=1;f<r;f++)c[f-1]=arguments[f];e=e.apply(void 0,c)}if(e===!0&&(e=void 0),!e){if(e===void 0||e===!1)return e;throw new Error("`".concat(t,"` was specified but was not a node, or did not return a node"))}var d=e;if(typeof e=="string"&&(d=i.querySelector(e),!d))throw new Error("`".concat(t,"` as selector refers to no known node"));return d},k=function(){var t=D("initialFocus");if(t===!1)return!1;if(t===void 0||!A(t,s.tabbableOptions))if(T(i.activeElement)>=0)t=i.activeElement;else{var e=n.tabbableGroups[0],r=e&&e.firstTabbableNode;t=r||D("fallbackFocus")}if(!t)throw new Error("Your focus-trap needs to have at least one focusable element");return t},P=function(){if(n.containerGroups=n.containers.map(function(t){var e=W(t,s.tabbableOptions),r=X(t,s.tabbableOptions),c=e.length>0?e[0]:void 0,f=e.length>0?e[e.length-1]:void 0,d=r.find(function(p){return N(p)}),v=r.slice().reverse().find(function(p){return N(p)}),m=!!e.find(function(p){return E(p)>0});return{container:t,tabbableNodes:e,focusableNodes:r,posTabIndexesFound:m,firstTabbableNode:c,lastTabbableNode:f,firstDomTabbableNode:d,lastDomTabbableNode:v,nextTabbableNode:function(w){var R=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,y=e.indexOf(w);return y<0?R?r.slice(r.indexOf(w)+1).find(function(K){return N(K)}):r.slice(0,r.indexOf(w)).reverse().find(function(K){return N(K)}):e[y+(R?1:-1)]}}}),n.tabbableGroups=n.containerGroups.filter(function(t){return t.tabbableNodes.length>0}),n.tabbableGroups.length<=0&&!D("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(n.containerGroups.find(function(t){return t.posTabIndexesFound})&&n.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},oe=function l(t){var e=t.activeElement;if(e)return e.shadowRoot&&e.shadowRoot.activeElement!==null?l(e.shadowRoot):e},F=function l(t){if(t!==!1&&t!==oe(document)){if(!t||!t.focus){l(k());return}t.focus({preventScroll:!!s.preventScroll}),n.mostRecentlyFocusedNode=t,le(t)&&t.select()}},S=function(t){var e=D("setReturnFocus",t);return e||(e===!1?!1:t)},U=function(t){var e=t.target,r=t.event,c=t.isBackward,f=c===void 0?!1:c;e=e||j(r),P();var d=null;if(n.tabbableGroups.length>0){var v=T(e,r),m=v>=0?n.containerGroups[v]:void 0;if(v<0)f?d=n.tabbableGroups[n.tabbableGroups.length-1].lastTabbableNode:d=n.tabbableGroups[0].firstTabbableNode;else if(f){var p=re(n.tabbableGroups,function(x){var G=x.firstTabbableNode;return e===G});if(p<0&&(m.container===e||A(e,s.tabbableOptions)&&!N(e,s.tabbableOptions)&&!m.nextTabbableNode(e,!1))&&(p=v),p>=0){var w=p===0?n.tabbableGroups.length-1:p-1,R=n.tabbableGroups[w];d=E(e)>=0?R.lastTabbableNode:R.lastDomTabbableNode}else C(r)||(d=m.nextTabbableNode(e,!1))}else{var y=re(n.tabbableGroups,function(x){var G=x.lastTabbableNode;return e===G});if(y<0&&(m.container===e||A(e,s.tabbableOptions)&&!N(e,s.tabbableOptions)&&!m.nextTabbableNode(e))&&(y=v),y>=0){var K=y===n.tabbableGroups.length-1?0:y+1,$=n.tabbableGroups[K];d=E(e)>=0?$.firstTabbableNode:$.firstDomTabbableNode}else C(r)||(d=m.nextTabbableNode(e))}}else d=D("fallbackFocus");return d},L=function(t){var e=j(t);if(!(T(e,t)>=0)){if(B(s.clickOutsideDeactivates,t)){g.deactivate({returnFocus:s.returnFocusOnDeactivate});return}B(s.allowOutsideClick,t)||t.preventDefault()}},q=function(t){var e=j(t),r=T(e,t)>=0;if(r||e instanceof Document)r&&(n.mostRecentlyFocusedNode=e);else{t.stopImmediatePropagation();var c,f=!0;if(n.mostRecentlyFocusedNode)if(E(n.mostRecentlyFocusedNode)>0){var d=T(n.mostRecentlyFocusedNode),v=n.containerGroups[d].tabbableNodes;if(v.length>0){var m=v.findIndex(function(p){return p===n.mostRecentlyFocusedNode});m>=0&&(s.isKeyForward(n.recentNavEvent)?m+1<v.length&&(c=v[m+1],f=!1):m-1>=0&&(c=v[m-1],f=!1))}}else n.containerGroups.some(function(p){return p.tabbableNodes.some(function(w){return E(w)>0})})||(f=!1);else f=!1;f&&(c=U({target:n.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(n.recentNavEvent)})),F(c||n.mostRecentlyFocusedNode||k())}n.recentNavEvent=void 0},ie=function(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;n.recentNavEvent=t;var r=U({event:t,isBackward:e});r&&(C(t)&&t.preventDefault(),F(r))},H=function(t){if(de(t)&&B(s.escapeDeactivates,t)!==!1){t.preventDefault(),g.deactivate();return}(s.isKeyForward(t)||s.isKeyBackward(t))&&ie(t,s.isKeyBackward(t))},M=function(t){var e=j(t);T(e,t)>=0||B(s.clickOutsideDeactivates,t)||B(s.allowOutsideClick,t)||(t.preventDefault(),t.stopImmediatePropagation())},Y=function(){if(n.active)return ae.activateTrap(b,g),n.delayInitialFocusTimer=s.delayInitialFocus?ne(function(){F(k())}):F(k()),i.addEventListener("focusin",q,!0),i.addEventListener("mousedown",L,{capture:!0,passive:!1}),i.addEventListener("touchstart",L,{capture:!0,passive:!1}),i.addEventListener("click",M,{capture:!0,passive:!1}),i.addEventListener("keydown",H,{capture:!0,passive:!1}),g},V=function(){if(n.active)return i.removeEventListener("focusin",q,!0),i.removeEventListener("mousedown",L,!0),i.removeEventListener("touchstart",L,!0),i.removeEventListener("click",M,!0),i.removeEventListener("keydown",H,!0),g},ue=function(t){var e=t.some(function(r){var c=Array.from(r.removedNodes);return c.some(function(f){return f===n.mostRecentlyFocusedNode})});e&&F(k())},I=typeof window<"u"&&"MutationObserver"in window?new MutationObserver(ue):void 0,O=function(){I&&(I.disconnect(),n.active&&!n.paused&&n.containers.map(function(t){I.observe(t,{subtree:!0,childList:!0})}))};return g={get active(){return n.active},get paused(){return n.paused},activate:function(t){if(n.active)return this;var e=h(t,"onActivate"),r=h(t,"onPostActivate"),c=h(t,"checkCanFocusTrap");c||P(),n.active=!0,n.paused=!1,n.nodeFocusedBeforeActivation=i.activeElement,e?.();var f=function(){c&&P(),Y(),O(),r?.()};return c?(c(n.containers.concat()).then(f,f),this):(f(),this)},deactivate:function(t){if(!n.active)return this;var e=te({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},t);clearTimeout(n.delayInitialFocusTimer),n.delayInitialFocusTimer=void 0,V(),n.active=!1,n.paused=!1,O(),ae.deactivateTrap(b,g);var r=h(e,"onDeactivate"),c=h(e,"onPostDeactivate"),f=h(e,"checkCanReturnFocus"),d=h(e,"returnFocus","returnFocusOnDeactivate");r?.();var v=function(){ne(function(){d&&F(S(n.nodeFocusedBeforeActivation)),c?.()})};return d&&f?(f(S(n.nodeFocusedBeforeActivation)).then(v,v),this):(v(),this)},pause:function(t){if(n.paused||!n.active)return this;var e=h(t,"onPause"),r=h(t,"onPostPause");return n.paused=!0,e?.(),V(),O(),r?.(),this},unpause:function(t){if(!n.paused||!n.active)return this;var e=h(t,"onUnpause"),r=h(t,"onPostUnpause");return n.paused=!1,e?.(),P(),Y(),O(),r?.(),this},updateContainerElements:function(t){var e=[].concat(t).filter(Boolean);return n.containers=e.map(function(r){return typeof r=="string"?i.querySelector(r):r}),n.active&&P(),O(),this}},g.updateContainerElements(a),g};function ye(o,a){let{el:u}=o,i=a?.focusTrapEl||u;if(!i)return;let b=J(z({clickOutsideDeactivates:!0,escapeDeactivates:!1,fallbackFocus:i,setReturnFocus:s=>(_(s),!1)},a?.focusTrapOptions),{document:u.ownerDocument,tabbableOptions:Z,trapStack:Q});o.focusTrap=me(i,b)}function Fe(o,a){o.focusTrapDisabled||o.focusTrap?.activate(a)}function we(o,a){o.focusTrap?.deactivate(a)}function Ne(o){o.focusTrap?.updateContainerElements(o.el)}export{ye as a,Fe as b,we as c,Ne as d};
