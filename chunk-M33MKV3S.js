import{a as It}from"./chunk-RQQJT345.js";import{c as j,e as ct,f as mt,g as ft,h as A,s as O,t as pt,w as ht}from"./chunk-UHE637ZN.js";import{a as T}from"./chunk-TNPL7MIN.js";import{a as d,d as at,e as G,f as lt,g as ut}from"./chunk-IWJQ3PU6.js";import{a as q}from"./chunk-FYZRIMPP.js";import{h as V,q as yt,s as gt}from"./chunk-ATXTHXJA.js";import{m as st}from"./chunk-4HUAEW4D.js";import{e as z,g as tt,h as et,m as rt,n as nt,q as it,u as ot}from"./chunk-SO6OJFOM.js";import{F as E,G as C,_ as H,r as M,u as $,y as b}from"./chunk-OFVMJORF.js";import{a as X}from"./chunk-MT7BXRRQ.js";import{z as K}from"./chunk-JKP4I6UL.js";import{s as F}from"./chunk-BRWS572J.js";import{m as D}from"./chunk-AKNRR36C.js";import{g}from"./chunk-JEGVIFEP.js";var Y=[0,0];function Rt(t,e){if(!e)return null;if("x"in e){let r={x:0,y:0};return[r.x,r.y]=t(e.x,e.y,Y),e.z!=null&&(r.z=e.z),e.m!=null&&(r.m=e.m),r}if("xmin"in e){let r={xmin:0,ymin:0,xmax:0,ymax:0};return[r.xmin,r.ymin]=t(e.xmin,e.ymin,Y),[r.xmax,r.ymax]=t(e.xmax,e.ymax,Y),e.hasZ&&(r.zmin=e.zmin,r.zmax=e.zmax,r.hasZ=!0),e.hasM&&(r.mmin=e.mmin,r.mmax=e.mmax,r.hasM=!0),r}return"rings"in e?{rings:St(e.rings,t),hasM:e.hasM,hasZ:e.hasZ}:"paths"in e?{paths:St(e.paths,t),hasM:e.hasM,hasZ:e.hasZ}:"points"in e?{points:xt(e.points,t),hasM:e.hasM,hasZ:e.hasZ}:null}function St(t,e){let r=[];for(let n of t)r.push(xt(n,e));return r}function xt(t,e){let r=[];for(let n of t){let i=e(n[0],n[1],[0,0]);r.push(i),n.length>2&&i.push(n[2]),n.length>3&&i.push(n[3])}return r}function w(t,e){return g(this,null,function*(){if(!t||!e)return;let r=Array.isArray(t)?t.map(n=>n.geometry!=null?n.geometry.spatialReference:null).filter(D):[t];yield gt(r.map(n=>({source:n,dest:e})))})}var dt=Rt.bind(null,tt),Nt=Rt.bind(null,et);function Z(t,e,r,n){if(!t||(r||(r=e,e=t.spatialReference),!E(e)||!E(r)||M(e,r)))return t;if(z(e,r)){let i=b(r)?dt(t):Nt(t);return i.spatialReference=r,i}return V(q,[t],e,r,null,n)[0]}var U=class{constructor(){this._jobs=[],this._timer=null,this._process=this._process.bind(this)}push(e,r,n,i){return g(this,null,function*(){if(!e?.length||!r||!n||M(r,n))return e;let o={geometries:e,inSpatialReference:r,outSpatialReference:n,geographicTransformation:i,resolve:K()};return this._jobs.push(o),this._timer??=setTimeout(this._process,10),o.resolve.promise})}_process(){this._timer=null;let e=this._jobs.shift();if(!e)return;let{geometries:r,inSpatialReference:n,outSpatialReference:i,resolve:o,geographicTransformation:s}=e;z(n,i)?b(i)?o(r.map(dt)):o(r.map(Nt)):o(V(q,r,n,i,s,null)),this._jobs.length>0&&(this._timer=setTimeout(this._process,10))}},Ft=new U;function ae(t,e,r,n){return Ft.push(t,e,r,n)}var Tt=new T,jt=new T,k=new T,J={esriGeometryPoint:j,esriGeometryPolyline:mt,esriGeometryPolygon:ft,esriGeometryMultipoint:ct};function fe(t,e,r,n=t.hasZ,i=t.hasM){if(e==null)return null;let o=t.hasZ&&n,s=t.hasM&&i;if(r){let a=O(k,e,t.hasZ,t.hasM,"esriGeometryPoint",r,n,i);return j(a,o,s)}return j(e,o,s)}function v(t,e,r,n,i,o,s=e,a=r){let l=e&&s,u=r&&a,m=n!=null?"coords"in n?n:n.geometry:null;if(m==null)return null;if(i){let c=pt(jt,m,e,r,t,i,s,a);return o&&(c=O(k,c,l,u,t,o)),J[t]?.(c,l,u)??null}if(o){let c=O(k,m,e,r,t,o,s,a);return J[t]?.(c,l,u)??null}return ht(Tt,m,e,r,s,a),J[t]?.(Tt,l,u)??null}function pe(t){return t&&Pt in t?JSON.parse(JSON.stringify(t,Ot)):t}var Pt="_geVersion",Ot=(t,e)=>t!==Pt?e:void 0;var Ct=new X({esriSRUnit_Meter:"meters",esriSRUnit_Kilometer:"kilometers",esriSRUnit_Foot:"feet",esriSRUnit_StatuteMile:"miles",esriSRUnit_NauticalMile:"nautical-miles",esriSRUnit_USNauticalMile:"us-nautical-miles"}),Et=Object.freeze({});function Te(t,e,r){return g(this,null,function*(){let{outFields:n,orderByFields:i,groupByFieldsForStatistics:o,outStatistics:s}=t;if(n)for(let a=0;a<n.length;a++)n[a]=n[a].trim();if(i)for(let a=0;a<i.length;a++)i[a]=i[a].trim();if(o)for(let a=0;a<o.length;a++)o[a]=o[a].trim();if(s)for(let a=0;a<s.length;a++)s[a].onStatisticField&&(s[a].onStatisticField=s[a].onStatisticField.trim());return t.geometry&&!t.outSR&&(t.outSR=t.geometry.spatialReference),zt(t,e,r)})}function zt(t,e,r){return g(this,null,function*(){if(!t)return null;let{where:n}=t;if(t.where=n=n?.trim(),(!n||/^1 *= *1$/.test(n)||e&&e===n)&&(t.where=null),!t.geometry)return t;let i=yield qt(t);if(t.distance=0,t.units=null,t.spatialRel==="esriSpatialRelEnvelopeIntersects"){let{spatialReference:o}=t.geometry;i=st(i),i.spatialReference=o}if(i){yield w(i.spatialReference,r),i=At(i,r);let o=(yield It(lt(i)))[0];if(o==null)throw Et;let s="quantizationParameters"in t&&t.quantizationParameters?.tolerance||"maxAllowableOffset"in t&&t.maxAllowableOffset||0,a=s&&Gt(i,r)?{densificationStep:8*s}:void 0,l=o.toJSON(),u=Z(l,l.spatialReference,r,a);if(!u)throw Et;u.spatialReference=r,t.geometry=u}return t})}function Gt(t,e){if(!t)return!1;let r=t.spatialReference;return(d(t)||G(t)||at(t))&&!M(r,e)&&!yt(r,e)}function At(t,e){let r=t.spatialReference;return Gt(t,e)&&d(t)?{spatialReference:r,rings:[[[t.xmin,t.ymin],[t.xmin,t.ymax],[t.xmax,t.ymax],[t.xmax,t.ymin],[t.xmin,t.ymin]]]}:t}function qt(t){return g(this,null,function*(){let{distance:e,units:r}=t,n=t.geometry;if(e==null||"vertexAttributes"in n)return n;let i=n.spatialReference,o=r?Ct.fromJSON(r):H(i),s=i&&($(i)||b(i))?n:yield w(i,C).then(()=>Z(n,C));return(yield Vt())(s.spatialReference,s,e,o)})}function Vt(){return g(this,null,function*(){return(yield import("./chunk-REJPHZXN.js")).geodesicBuffer})}function Mt(t){return t==="mesh"?it:ot(t)}function bt(t,e){return t?e?4:3:e?3:2}function wt(t,e,r,n){return _t(t,e,r,n.coords[0],n.coords[1])}function vt(t,e,r,n,i,o){let s=bt(i,o),{coords:a,lengths:l}=n;if(!l)return!1;for(let u=0,m=0;u<l.length;u++,m+=s)if(!_t(t,e,r,a[m],a[m+1]))return!1;return!0}function _t(t,e,r,n,i){if(!t)return!1;let o=bt(e,r),{coords:s,lengths:a}=t,l=!1,u=0;for(let m of a)l=Yt(l,s,o,u,m,n,i),u+=m*o;return l}function Yt(t,e,r,n,i,o,s){let a=t,l=n;for(let u=n,m=n+i*r;u<m;u+=r){l=u+r,l===m&&(l=n);let c=e[u],f=e[u+1],p=e[l],h=e[l+1];(f<s&&h>=s||h<s&&f>=s)&&c+(s-f)/(h-f)*(p-c)<o&&(a=!a)}return a}var W="unsupported-query",Ut={esriSpatialRelIntersects:"intersects",esriSpatialRelContains:"contains",esriSpatialRelCrosses:"crosses",esriSpatialRelDisjoint:"disjoint",esriSpatialRelEnvelopeIntersects:"intersects",esriSpatialRelIndexIntersects:null,esriSpatialRelOverlaps:"overlaps",esriSpatialRelTouches:"touches",esriSpatialRelWithin:"within",esriSpatialRelRelation:null},Q={spatialRelationship:{esriSpatialRelIntersects:!0,esriSpatialRelContains:!0,esriSpatialRelWithin:!0,esriSpatialRelCrosses:!0,esriSpatialRelDisjoint:!0,esriSpatialRelTouches:!0,esriSpatialRelOverlaps:!0,esriSpatialRelEnvelopeIntersects:!0,esriSpatialRelIndexIntersects:!1,esriSpatialRelRelation:!1},queryGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!0},layerGeometry:{esriGeometryPoint:!0,esriGeometryMultipoint:!0,esriGeometryPolyline:!0,esriGeometryPolygon:!0,esriGeometryEnvelope:!1}};function Zt(t){return t!=null&&Q.spatialRelationship[t]===!0}function Jt(t){return t!=null&&Q.queryGeometry[ut(t)]===!0}function kt(t){return t!=null&&Q.layerGeometry[t]===!0}function Wt(){return import("./chunk-REJPHZXN.js")}function Qe(t,e,r,n,i){if(G(e)&&r==="esriGeometryPoint"&&(t==="esriSpatialRelIntersects"||t==="esriSpatialRelContains")){let o=A(new T,e,!1,!1);return Promise.resolve(s=>wt(o,!1,!1,s))}if(G(e)&&r==="esriGeometryMultipoint"){let o=A(new T,e,!1,!1);if(t==="esriSpatialRelContains")return Promise.resolve(s=>vt(o,!1,!1,s,n,i))}if(d(e)&&r==="esriGeometryPoint"&&(t==="esriSpatialRelIntersects"||t==="esriSpatialRelContains"))return Promise.resolve(o=>rt(e,v(r,n,i,o)));if(d(e)&&r==="esriGeometryMultipoint"&&t==="esriSpatialRelContains")return Promise.resolve(o=>nt(e,v(r,n,i,o)));if(d(e)&&t==="esriSpatialRelIntersects"){let o=Mt(r);return Promise.resolve(s=>o(e,v(r,n,i,s)))}return Wt().then(o=>{let s=o[Ut[t]].bind(null,e.spatialReference,e);return a=>s(v(r,n,i,a))})}function Be(t,e,r){return g(this,null,function*(){let{spatialRel:n,geometry:i}=t;if(i){if(!Zt(n))throw new F(W,"Unsupported query spatial relationship",{query:t});if(E(i.spatialReference)&&E(r)){if(!Jt(i))throw new F(W,"Unsupported query geometry type",{query:t});if(!kt(e))throw new F(W,"Unsupported layer geometry type",{query:t});if(t.outSR)return w(t.geometry?.spatialReference,t.outSR)}}})}function Le(t){if(d(t))return!0;if(G(t)){for(let e of t.rings)if(e.length!==5||e[0][0]!==e[1][0]||e[0][0]!==e[4][0]||e[2][0]!==e[3][0]||e[0][1]!==e[3][1]||e[0][1]!==e[4][1]||e[1][1]!==e[2][1])return!1;return!0}return!1}function Xe(t,e){return g(this,null,function*(){if(!t)return null;let r=e.featureAdapter,{startTimeField:n,endTimeField:i}=t,o=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;if(n&&i)yield e.forEach(a=>{let l=r.getAttribute(a,n),u=r.getAttribute(a,i);l==null||isNaN(l)||(o=Math.min(o,l)),u==null||isNaN(u)||(s=Math.max(s,u))});else{let a=n||i;yield e.forEach(l=>{let u=r.getAttribute(l,a);u==null||isNaN(u)||(o=Math.min(o,u),s=Math.max(s,u))})}return{start:o,end:s}})}function $e(t,e,r){if(!e||!t)return null;let{startTimeField:n,endTimeField:i}=t;if(!n&&!i)return null;let{start:o,end:s}=e;if(o===null&&s===null)return null;if(o===void 0&&s===void 0)return Lt();let a=r.getAttributeAsTimestamp?.bind(r)??r.getAttribute.bind(r);return n&&i?Qt(a,n,i,o,s):Bt(a,n||i,o,s)}function Qt(t,e,r,n,i){return n!=null&&i!=null?o=>{let s=t(o,e),a=t(o,r);return(s==null||s<=i)&&(a==null||a>=n)}:n!=null?o=>{let s=t(o,r);return s==null||s>=n}:i!=null?o=>{let s=t(o,e);return s==null||s<=i}:void 0}function Bt(t,e,r,n){return r!=null&&n!=null&&r===n?i=>t(i,e)===r:r!=null&&n!=null?i=>{let o=t(i,e);return o!=null&&o>=r&&o<=n}:r!=null?i=>{let o=t(i,e);return o!=null&&o>=r}:n!=null?i=>{let o=t(i,e);return o!=null&&o<=n}:void 0}function Lt(){return()=>!1}function B(t,e){return t?e?4:3:e?3:2}function er(t,e,r,n){if(!e?.lengths.length)return null;t.lengths.length&&(t.lengths.length=0),t.coords.length&&(t.coords.length=0);let i=t.coords,o=[],s=r?[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY]:[Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY],{lengths:a,coords:l}=e,u=B(r,n),m=0;for(let c of a){let f=Dt(s,l,m,c,r,n);f&&o.push(f),m+=c*u}if(o.sort((c,f)=>{let p=c[2]-f[2];return p===0&&r&&(p=c[4]-f[4]),p}),o.length){let c=6*o[0][2];i[0]=o[0][0]/c,i[1]=o[0][1]/c,r&&(c=6*o[0][4],i[2]=c!==0?o[0][3]/c:0),(i[0]<s[0]||i[0]>s[1]||i[1]<s[2]||i[1]>s[3]||r&&(i[2]<s[4]||i[2]>s[5]))&&(i.length=0)}if(!i.length){let c=e.lengths[0]?Kt(l,0,a[0],r,n):null;if(!c)return null;i[0]=c[0],i[1]=c[1],r&&c.length>2&&(i[2]=c[2])}return t}function Dt(t,e,r,n,i,o){let s=B(i,o),a=r,l=r+s,u=0,m=0,c=0,f=0,p=0;for(let N=0,_=n-1;N<_;N++,a+=s,l+=s){let y=e[a],I=e[a+1],R=e[a+2],S=e[l],x=e[l+1],L=e[l+2],P=y*x-S*I;f+=P,u+=(y+S)*P,m+=(I+x)*P,i&&(P=y*L-S*R,c+=(R+L)*P,p+=P),y<t[0]&&(t[0]=y),y>t[1]&&(t[1]=y),I<t[2]&&(t[2]=I),I>t[3]&&(t[3]=I),i&&(R<t[4]&&(t[4]=R),R>t[5]&&(t[5]=R))}if(f>0&&(f*=-1),p>0&&(p*=-1),!f)return null;let h=[u,m,.5*f];return i&&(h[3]=c,h[4]=.5*p),h}function Kt(t,e,r,n,i){let o=B(n,i),s=e,a=e+o,l=0,u=0,m=0,c=0;for(let f=0,p=r-1;f<p;f++,s+=o,a+=o){let h=t[s],N=t[s+1],_=t[s+2],y=t[a],I=t[a+1],R=t[a+2],S=n?$t(h,N,_,y,I,R):Xt(h,N,y,I);if(S)if(l+=S,n){let x=te(h,N,_,y,I,R);u+=S*x[0],m+=S*x[1],c+=S*x[2]}else{let x=Ht(h,N,y,I);u+=S*x[0],m+=S*x[1]}}return l>0?n?[u/l,m/l,c/l]:[u/l,m/l]:r>0?n?[t[e],t[e+1],t[e+2]]:[t[e],t[e+1]]:null}function Xt(t,e,r,n){let i=r-t,o=n-e;return Math.sqrt(i*i+o*o)}function $t(t,e,r,n,i,o){let s=n-t,a=i-e,l=o-r;return Math.sqrt(s*s+a*a+l*l)}function Ht(t,e,r,n){return[t+.5*(r-t),e+.5*(n-e)]}function te(t,e,r,n,i,o){return[t+.5*(n-t),e+.5*(i-e),r+.5*(o-r)]}export{fe as a,v as b,pe as c,er as d,w as e,Z as f,ae as g,Et as h,Te as i,zt as j,Qe as k,Be as l,Le as m,Xe as n,$e as o};
